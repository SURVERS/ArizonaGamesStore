История изменений – Arizona Games Store

07.01.2026 – Добавил Swagger и почистил проект

Новые функции

Swagger UI - интерактивная документация API

Что сделал: Добавил полноценную Swagger документацию для всех эндпоинтов бэкенда. Теперь можно посмотреть что умеет API и протестировать прямо в браузере.

Где смотреть: После запуска бэка открой http://localhost:8080/swagger/index.html

Что там есть:
- Описания всех эндпоинтов (написаны по-человечески, без корпоративного языка)
- Возможность тестировать API через кнопку "Try it out"
- Примеры запросов и ответов
- JWT авторизация через кнопку "Authorize"
- Группировка по тегам (Аутентификация, Объявления, Отзывы, и т.д.)

Технические детали:
- Используется swaggo/swag для генерации документации
- Все описания в файлах backend/docs/endpoints.go и backend/docs/models.go
- При изменении аннотаций нужно запустить swag init в папке backend

Зачем: Чтобы фронтенд разработчики (или я в будущем) быстро разобрались какие эндпоинты есть и как ими пользоваться. Плюс можно показать работодателям - выглядит профессионально.

Технические правки (рефакторинг)

Удалил все комментарии из пользовательских файлов

Что сделал: Прошёлся по всем файлам backend (Go) и frontend (JSX/CSS) и убрал лишние комментарии. Код стал чище.

Что НЕ трогал: Стандартные файлы (node_modules, конфиги, и т.д.)

Удалил папку react-admin

Зачем была: Это был эксперимент с админ-панелью через react-admin.
Почему удалил: В итоге не пригодилась, только место занимала.

Создал .gitignore

Что добавил туда:
- node_modules/
- .env файлы
- Логи
- Uploads
- Временные файлы
- IDE настройки (.vscode, .claude)
- Скомпилированные файлы

Обновил README.md

Что изменил:
- Добавил раздел про Swagger UI с инструкцией
- Расписал все технологии, которые использую
- Написал более живо, как бы писал junior разработчик для портфолио
- Добавил раздел "Что я узнал делая проект"
- Указал примеры запуска и настройки

03.01.2026 – Починили рейтинги и счётчик в «Транспорте»

Исправленные баги

Рейтинг в карточках всегда показывал 5.0

Что было: У всех в объявлениях горел рейтинг 5.0, даже у новичков с нулём.

Почему: В коде стояло {ad.author_rating || 5.0}. Если рейтинг был 0, то он считался как «ложь», и подставлялась пятёрка. Логика сломана.

Как починили: Заменили на {(ad.author_rating || 0).toFixed(1)}. Теперь у кого 0, у того и отображается «0.0».

Где меняли: Во всех компонентах с объявлениями (Accs.jsx, Vehicle.jsx и т.д.).

В разделе «Транспорт» не работал счётчик объявлений и ничего не грузилось

Что было: На странице «Транспорт» всегда было «Всего объявлений: 0», и список был пуст.

Почему: В коде категорию называли vehicle, а в базе данных она записана как vehicles (с буквой s на конце). Запросы не находили совпадений.

Как починили: Прошёлся по всему файлу Vehicle.jsx и заменил vehicle на vehicles в запросах на бэкенд.

Где меняли: frontend/src/components/Vehicle.jsx (три места).

Как это работает (для себя):

Счётчики лежат в отдельной таблице statistics. Когда создаёшь объявление – счётчик +1, удаляешь – -1.

Рейтинг юзера тянется из таблицы accounts и подставляется в объявления.

03.01.2026 – Ещё фиксы и парочка новых фич

Исправленные баги

Баг при смене ника: объявления оставались со старым ником

Что было: Меняешь ник в настройках, а в твоих объявлениях всё ещё старый. В профиле их не видно, будто не твои.

Как починили: На бэкенде сделал, чтобы смена ника обновляла его во ВСЕХ твоих объявлениях сразу. Всё в одной транзакции: если ошибка где-то – откатится всё.

Где меняли: backend/services/account.go.

Новые функции

Тёмная и светлая тема

Что сделал: Теперь можно переключать тему в настройках. Выбор сохраняется в профиле.

Как работает: На фронте через AuthContext управляю темой. В CSS прописал переменные типа --bg-primary. Для светлой темы просто меняю их значения.

Важно: Пришлось потом допиливать стили, потому что в светлой теме некоторые кнопки и футер оставались тёмными. Пофиксил в BottomNavigation.css, Feed.css и других.

Онлайн-статус теперь внутри аватарки

Что было: Раньше рядом с аватаром был текст «Онлайн» или «Был(а) ... назад».

Что стало: Зелёная точка (или серая для оффлайна) теперь в правом нижнем углу аватарки. Чище смотрится.

Где менял: Profile.jsx и стили в Profile.css.

Теперь при каждом входе обновляется last_ip

Зачем: Чтобы в базе был актуальный IP пользователя.

Как: Фронт при логине дергает внешний API (api.seeip.org), чтобы узнать свой реальный IP, и шлёт его на бэк. Бэк сохраняет в поле last_ip таблицы accounts.

Защита от создания кучи аккаунтов с одного IP

Что сделал: Нельзя зарегить больше 3 аккаунтов с одного айпи. Если лимит превысили – ставится кука reg_blocked на год, и дальше регистрация блокируется совсем (даже если IP сменится).

Где: Логика в backend/services/account.go и email.go.

Редактирование описания профиля

Что сделал: В настройках добавил поле, где можно поменять «О себе». Лимит 200 символов, есть счётчик.

Безопасность: На бэке строго валидирую ввод: вырезаю все HTML-теги, JS-код, SQL-команды. Защита от XSS и инъекций.

Технические правки (рефакторинг)

Разделил handlers и services. Раньше в хендлерах был прямой доступ к базе, сейчас всю работу с БД вынес в сервисы (services/). Код стал чище.

Пофиксил сохранение IP при регистрации. Раньше поля reg_ip и last_ip оставались пустыми. Теперь при подтверждении почты IP клиента корректно сохраняется.

Что ещё поправил по мелочи:

В светлой теме не было видно активной иконки в нижнем меню (белая на белом). Убрал inline-стили, сделал через CSS-фильтры.

В настройках в светлой теме не было видно надписи «Вы: {nickname}». Добавил правило в CSS.

В планах (как вспомню):

Возможно, добавить автоматическое переключение темы по времени суток.

Ещё пару тем на выбор (не только светлая/тёмная).