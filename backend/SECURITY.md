# Меры безопасности

## Реализованные защиты

### 1. Rate Limiting (Ограничение запросов)

#### Регистрация
- **Лимит**: 3 попытки в час с одного IP
- **Блокировка**: автоматическая на 1 час
- **Сообщение**: "Слишком много попыток регистрации. Попробуйте позже"

#### Логин
- **Лимит**: 10 попыток за 15 минут с одного IP
- **Блокировка**: автоматическая на 15 минут
- **Сообщение**: "Слишком много попыток входа. Попробуйте через 15 минут"

### 2. Валидация входных данных

#### Никнейм
- Длина: 3-20 символов
- Разрешены: английские буквы, цифры, подчёркивание (_)
- Блокировка SQL injection паттернов
- Блокировка XSS паттернов

#### Пароль
- Длина: 6-100 символов
- Блокировка опасных символов (< >)
- Блокировка SQL/JS injection паттернов
- Хеширование через bcrypt

### 3. JWT Токены

- **Access Token**: 3 минуты жизни
- **Refresh Token**: 30 дней, хранится в БД
- HttpOnly cookies (защита от XSS)
- SameSite=Lax (защита от CSRF)

### 4. CORS

- Whitelist разрешенных origins
- AllowCredentials для работы с cookies
- Блокировка неизвестных источников

## Дополнительные меры (рекомендуется)

### 1. CAPTCHA
Добавить Google reCAPTCHA v3 или hCaptcha для:
- Регистрации
- Логина (после 3 неудачных попыток)

### 2. Email подтверждение
- Отправка кода подтверждения на email
- Активация аккаунта через ссылку

### 3. IP Blacklist
- Автоматическая блокировка IP после X неудачных попыток
- Возможность ручного добавления в blacklist

### 4. Логирование
- Логирование всех попыток регистрации/логина
- Мониторинг подозрительной активности
- Алерты при массовых попытках

### 5. Fingerprinting
- Проверка browser fingerprint
- Блокировка автоматизированных инструментов

### 6. Двухфакторная аутентификация (2FA)
- TOTP (Google Authenticator)
- SMS коды
- Email коды

## Текущие уязвимости

1. Нет CAPTCHA - возможен обход rate limiting через VPN/прокси
2. Нет email подтверждения - можно создавать фейковые аккаунты
3. Rate limiting по IP - легко обойти через прокси
4. Нет защиты от credential stuffing

## Рекомендации для продакшена

1. Добавить CAPTCHA (минимум)
2. Включить email верификацию
3. Настроить HTTPS (обязательно!)
4. Использовать WAF (Web Application Firewall)
5. Регулярно обновлять зависимости
6. Мониторинг и алертинг
